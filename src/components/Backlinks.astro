---
/**
 * Backlinks component - shows notes that link to this one.
 * 
 * This is Andy-style bidirectional linking: see what context
 * other notes reference this one in.
 */

interface Props {
	slug: string;
}

const { slug } = Astro.props;

// Backlinks will be populated at build time by the backlinks integration
// This component just renders them - the data comes from the integration
let backlinks: { slug: string; title: string }[] = [];

// During build, the backlinks integration runs AFTER page generation,
// so we can't access backlinks.json yet. For now, this will show "No backlinks yet"
// until we implement a better solution (e.g., passing backlinks as props from the integration)
// 
// TODO: Pass backlinks data directly from the layout instead of fetching
---

{backlinks.length > 0 && (
	<section class="backlinks">
		<h3 class="text-sm font-semibold tracking-wide uppercase text-gray-500 dark:text-gray-400 mb-4">
			Links to this note
		</h3>
		<ul class="space-y-2">
			{backlinks.map(({ slug: linkSlug, title }) => (
				<li>
					<a 
						href={`/notes/${linkSlug}/`}
						class="text-sm text-[var(--sl-color-accent)] hover:underline hover:text-[var(--sl-color-accent-high)] block"
					>
						{title}
					</a>
				</li>
			))}
		</ul>
	</section>
)}

{backlinks.length === 0 && (
	<section class="backlinks">
		<h3 class="text-sm font-semibold tracking-wide uppercase text-gray-500 dark:text-gray-400 mb-4">
			Links to this note
		</h3>
		<p class="text-sm text-gray-500 dark:text-gray-400">
			No backlinks yet. Be the first to reference this note!
		</p>
	</section>
)}

